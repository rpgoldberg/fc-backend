# CodeQL Configuration
# Defines custom sanitizers for taint analysis

name: "Custom CodeQL Configuration"

# Use security-extended suite plus our custom queries
queries:
  - uses: security-extended
  # Use our custom log injection query that recognizes sanitizeArgs/sanitizeLogValue functions
  - uses: ./.github/codeql/queries/LogInjectionSanitizers.ql

# Exclude certain queries that have custom handling or are false positives
query-filters:
  # We replace the default log-injection with our custom version that recognizes sanitizers
  - exclude:
      id: js/log-injection
  # Exclude SSRF - URL is validated to myfigurecollection.net domain in scraper
  # This is intentional server-side scraping functionality for figure data extraction
  - exclude:
      id: js/request-forgery
  # MongoDB queries use Mongoose ODM which handles parameterization safely
  # The "sql-injection" alert is for NoSQL but Mongoose prevents injection attacks
  - exclude:
      id: js/sql-injection

# Include our custom query pack
packs:
  javascript:
    - ./.github/codeql/queries

# Path filters to exclude test files from analysis
paths-ignore:
  - "**/tests/**"
  - "**/__tests__/**"
  - "**/node_modules/**"
  - "**/dist/**"
